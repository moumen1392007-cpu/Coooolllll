<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¤– Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø°ÙƒÙŠ (Ù…Ø³ØªÙ‚Ø±)</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
body{font-family:'Tajawal',sans-serif}
.loader{border-top-color:#2563eb;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body class="bg-gray-100 p-4">
<div class="max-w-2xl mx-auto bg-white rounded-xl shadow p-6">
<h1 class="text-2xl font-bold text-center text-blue-600 mb-6">ğŸ¤– Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø°ÙƒÙŠ</h1>
<div id="upload">
<div class="border-2 border-dashed rounded-lg p-6 text-center bg-blue-50">
<input type="file" id="files" multiple accept=".pdf,.jpg,.png" class="hidden">
<label for="files" class="cursor-pointer text-blue-600">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ PDF Ø£Ùˆ ØµÙˆØ±</label>
<div id="count" class="text-sm text-gray-500 mt-2"></div>
</div>
<label class="block mt-4">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</label>
<input id="qcount" type="number" value="5" min="1" class="w-full border rounded p-2">
<button id="start" class="w-full mt-4 bg-blue-600 text-white py-3 rounded">Ø¨Ø¯Ø¡</button>
</div>
<div id="loading" class="hidden text-center py-8">
<div class="loader border-4 border-gray-200 rounded-full w-12 h-12 mx-auto mb-3"></div>
<p id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</p>
</div>
<div id="quiz" class="hidden">
<div class="flex justify-between text-sm mb-3">
<span>Ø³Ø¤Ø§Ù„ <span id="idx">1</span></span>
<span>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="score">0</span></span>
</div>
<h3 id="qtext" class="font-bold mb-4"></h3>
<div id="opts" class="space-y-2"></div>
<div id="exp" class="hidden mt-4 p-3 bg-blue-50 border-r-4 border-blue-600"></div>
<button id="next" class="hidden w-full mt-4 bg-green-600 text-white py-2 rounded">Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>
</div>
<script type="module">
import { GoogleGenerativeAI } from 'https://esm.sh/@google/generative-ai';document.addEventListener('DOMContentLoaded', () => { const API_KEY = "AIzaSyD8Wx3w8A2gYUkybvLVxfZk_uKOui_cMdc"; const genAI = new GoogleGenerativeAI(API_KEY); const models = ['gemini-1.5-flash-latest','gemini-1.5-pro-latest'];

const filesInput = document.getElementById('files'); const start = document.getElementById('start'); const upload = document.getElementById('upload'); const loading = document.getElementById('loading'); const quiz = document.getElementById('quiz'); const count = document.getElementById('count'); const status = document.getElementById('status'); const qcount = document.getElementById('qcount'); const idx = document.getElementById('idx'); const qtext = document.getElementById('qtext'); const opts = document.getElementById('opts'); const exp = document.getElementById('exp'); const next = document.getElementById('next'); const scoreEl = document.getElementById('score');

let files = [], questions = [], i = 0, score = 0;

pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

filesInput.addEventListener('change', (e) => { files = Array.from(e.target.files); count.textContent = ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${files.length} Ù…Ù„ÙØ§Øª; });

start.addEventListener('click', async () => { if (!files.length) return alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹'); upload.classList.add('hidden'); loading.classList.remove('hidden'); let text = '';

for (const f of files) {
  status.textContent = `Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† ${f.name}`;
  if (f.type === 'application/pdf') {
    const pdf = await pdfjsLib.getDocument(await f.arrayBuffer()).promise;
    for (let p = 1; p <= pdf.numPages; p++) {
      const page = await pdf.getPage(p);
      const c = await page.getTextContent();
      text += c.items.map(i => i.str).join(' ');
    }
  } else {
    const r = await Tesseract.recognize(f, 'ara');
    text += r.data.text;
  }
}

status.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©...';
const prompt = `Ø£Ù†Ø´Ø¦ ${qcount.value} Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.

Ø£Ø¹Ø¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© JSON ÙÙ‚Ø·. Ø§Ù„Ù†Øµ:${text.slice(0,12000)}`;

let raw;
for (const m of models) {
  try {
    const model = genAI.getGenerativeModel({ model: m });
    const r = await model.generateContent(prompt);
    raw = r.response.text();
    break;
  } catch (e) {}
}

questions = JSON.parse(raw.replace(/```json|```/g, ''));
show();

});

function show() { loading.classList.add('hidden'); quiz.classList.remove('hidden'); const q = questions[i]; idx.textContent = i + 1; qtext.textContent = q.question; exp.classList.add('hidden'); next.classList.add('hidden'); opts.innerHTML = '';

q.options.forEach((o, ix) => {
  const b = document.createElement('button');
  b.className = 'w-full border p-3 rounded';
  b.textContent = o;
  b.onclick = () => {
    [...opts.children].forEach(x => x.disabled = true);
    if (ix === q.answer) {
      b.classList.add('bg-green-100');
      score++;
      scoreEl.textContent = score;
    } else {
      b.classList.add('bg-red-100');
      opts.children[q.answer].classList.add('bg-green-100');
    }
    exp.textContent = 'ğŸ’¡ ' + q.explanation;
    exp.classList.remove('hidden');
    next.classList.remove('hidden');
  };
  opts.appendChild(b);
});

}

next.addEventListener('click', () => { i++; if (i < questions.length) show(); else { alert(Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${score}/${questions.length}); location.reload(); } }); }); </script>

</body>
</html>